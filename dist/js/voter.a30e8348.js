(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["voter"],{"0499":function(t,e,n){"use strict";var a=n("1594"),i=n.n(a);i.a},1594:function(t,e,n){},"5be1":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.connected&&t.results?n("div",{staticClass:"voter"},[t._l(t.results,(function(e,a){return n("v-sheet",{directives:[{name:"ripple",rawName:"v-ripple"}],key:a,staticClass:"d-flex align-center pa-1",style:{backgroundImage:"url("+e.image+")"},attrs:{dark:"",color:t.connected?"primary":"grey",tile:""},on:{click:function(e){return t.vote(a)}}},[n("div",{staticClass:"count white green--text"},[t._v(t._s(e.count))]),n("div",{staticClass:"title"},[t._v(t._s(e.number)+". "+t._s(e.name))])])})),n("v-sheet",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"d-flex align-center pa-1 justify-center align-center",staticStyle:{flex:"0 1 auto"},attrs:{dark:"",color:"error",tile:""},on:{click:function(e){return t.vote(-1)}}},[n("div",{staticClass:"title"},[t._v("TIDAK SAH")]),n("div",{staticClass:"count",staticStyle:{padding:"5px","min-width":"auto"}},[t._v(t._s(t.declined))])]),n("div",[n("v-toolbar",{staticClass:"pa-0",attrs:{tag:"div",dense:"",flat:""}},[n("v-toolbar-items",[n("v-btn",{attrs:{small:"",elevation:"0",color:"error"},on:{click:function(e){return t.selesai()}}},[t._v("\n            SELESAI\n          ")]),n("v-btn",{attrs:{small:"",elevation:"0",disabled:t.cannotUndo,color:"warning"},on:{click:function(e){return t.undo()}}},[t._v("\n            UNDO\n          ")])],1),n("v-spacer"),n("v-toolbar-items",[n("v-btn",{attrs:{small:"",elevation:"0"},on:{click:function(e){return t.goHome()}}},[t._v("\n            go Home\n          ")])],1)],1),n("div",{staticClass:"pt-1 text-center",domProps:{textContent:t._s(t.locationName)}})],1)],2):n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{attrs:{xs12:"",md4:""}},[n("v-sheet",{staticClass:"text-center pa-3 elevation-3",attrs:{dark:"",color:"Not Connected"==t.status?"error":"orange",height:"200"}},[n("h1",{staticClass:"title"},[t._v(t._s(t.status))])])],1)],1)],1)},i=[],o=n("6dbe"),s=n("95ad"),r=n("1fe4"),c=n("a0f5"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=-1,e.tps=-1,e.data={},e.resultData=null,e.isFinished=!1,e.results=[],e.status=null,e._ws=null,e._vote=new DataView(new ArrayBuffer(2)),e._undo=[],e}return Object(o["d"])(e,t),Object.defineProperty(e.prototype,"locationName",{get:function(){return this.data?this.data.locations[parseInt(this.$route.params["tps"])].name:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"declined",{get:function(){return this.resultData?this.resultData.declined:"?"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this.data.candidates||[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connected",{get:function(){return"Connected"==this.status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cannotUndo",{get:function(){return!this.$data._undo.length},enumerable:!0,configurable:!0}),e.prototype.undo=function(){this.vote(this.$data._undo.pop(),-1,!0)},e.prototype.goHome=function(){confirm("Anda yakin?")&&this.$router.push("/")},e.prototype.mounted=function(){var t=this;"function"==typeof window["WebSocket"]?(this.id=parseInt(this.$route.params["id"]),this.tps=parseInt(this.$route.params["tps"]),this.$api.listQuickcount().then((function(e){e[t.id]?(t.data=e[t.id],t.connectWs()):t.$router.replace("/voter")}))):alert("Perangkat anda tidak mendukung")},e.prototype.vote=function(t,e,n){if(void 0===e&&(e=1),!this.connected)return alert("Tidak terhubung dengan server");this.$data._vote.setInt8(0,t),this.$data._vote.setInt8(1,e),this.wsSend(this.$data._vote.buffer),n||this.$data._undo.push(t)},e.prototype.selesai=function(){var t=this;confirm("Anda yakin penghitungan di TPS anda sudah selesai?")&&Object(c["setTimeout"])((function(){confirm("Jika ini dinyatakan selesai, maka anda tidak bisa membatalkannya. Yakin Sudah Selesai?")&&(t.wsSend("SELESAI"),t.$router.replace("/result/"+t.id))}),2e3)},e.prototype.wsSend=function(t){this.$data._ws?this.$data._ws.send(t):console.error("Send message when no ws")},e.prototype.beforeDestroy=function(){this.$data._ws&&this.$data._ws.readyState!=WebSocket.CLOSED&&this.$data._ws.close()},e.prototype.connectWs=function(){var t=this,e=localStorage["voter_"+this.id+"_"+this.tps]||"",n=this.$api.getDirectUrl("/voter/voting/"+this.id+"/"+this.tps).replace(/^http(s)?/,"ws$1"),a=this.$data._ws=new WebSocket(n,e||void 0);this.status="Connecting",a.onopen=function(e){t.status="Connected"},a.onclose=function(e){console.log("WS CLOSED",e),t.status="Not Connected",t.$data._ws=void 0},a.onmessage=function(e){var n;if("string"==typeof e.data)switch(e.data[0]||null){case"{":t.resultData=JSON.parse(e.data),t.isFinished=!!t.resultData.finished,t.isFinished&&(alert("Quick Count Sudah Ditutup"),a.close(),t.$router.replace("/result/"+t.id)),(n=t.results).splice.apply(n,Object(o["f"])([0,t.results.length],t.data.candidates.map((function(e,n){return t.$set(e,"count",t.resultData.results[n]),e}))));break;case":":alert(e.data.substr(1)),t.$router.push("/voter");break;default:console.warn("Unhandled server message",e.data);break}else new Response(e.data).arrayBuffer().then((function(e){var n=new Int8Array(e),a=n[0],i=n[1];t.results[a]?(t.results[a].count+=i,t.resultData.accepted+=i):t.resultData.declined+=i,t.resultData.total=t.resultData.accepted+t.resultData.declined}))},a.onerror=function(e){t.status="Not Connected";try{a.close()}catch(n){}console.log("WS ERR",e)}},e.prototype.statusChanged=function(t,e){var n=this;this.isFinished||(document.title=this.data.name+" - "+t,"Not Connected"==this.status&&Object(c["setTimeout"])((function(){"Not Connected"==n.status&&(console.log("Reconnect WS"),n.connectWs())}),2e3))},Object(o["c"])([Object(s["d"])("status")],e.prototype,"statusChanged",null),e=Object(o["c"])([Object(s["a"])({name:"AdminDash",components:{VoteAddDialog:r["a"]}})],e),e}(s["c"]),u=l,d=u,f=(n("0499"),n("a6c2")),p=n("411c"),h=n.n(p),m=n("9c46"),v=n("04f4"),g=n("6a74"),b=n("db2c"),y=n("61ac"),w=n("1ae9"),T=n("79b8"),_=n("ab28"),k=n.n(_),x=n("5e35"),I=Object(f["a"])(d,a,i,!1,null,null,null);e["default"]=I.exports;h()(I,{VBtn:m["a"],VFlex:v["a"],VLayout:g["a"],VSheet:b["a"],VSpacer:y["a"],VToolbar:w["a"],VToolbarItems:T["a"]}),k()(I,{Ripple:x["a"]})},"5fea":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-content",[n("Navbar",{attrs:{back:"",color:"orange",title:"Voter Access"}}),n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{dark:"",color:"orange"}},[n("v-toolbar-title",[t._v("Pilih QuickCount")])],1),t._l(t.list,(function(e,a){return n("v-list-item",{directives:[{name:"show",rawName:"v-show",value:!e.hide,expression:"!item.hide"}],key:a,on:{click:function(n){return t.pilihQuickcount(a,e)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(e.name))])],1)],1)}))],2)],1)],1),n("v-dialog",{attrs:{"max-width":"290"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Passcode")]),n("v-card-text",[n("v-form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("v-text-field",{attrs:{label:"Passcode",autocomplete:"",type:"password",required:""},model:{value:t.passcode,callback:function(e){t.passcode=e},expression:"passcode"}},[n("template",{slot:"append-outer"},[n("v-btn",{attrs:{text:"",small:""},on:{click:t.submit}},[t._v("OK")])],1)],2)],1)],1)],1)],1),n("v-dialog",{attrs:{"max-width":"290"},model:{value:t.dialogTps,callback:function(e){t.dialogTps=e},expression:"dialogTps"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Pilih TPS")]),n("v-list",t._l(t.locations,(function(e,a){return n("v-list-item",{key:a,on:{click:function(n){return t.pilihTps(a,e)}}},[n("v-list-item-title",{domProps:{textContent:t._s(e.name)}})],1)})),1)],1)],1)],1)],1)},i=[],o=n("6dbe"),s=n("95ad"),r=n("d178"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dialog=!1,e.dialogTps=!1,e.list=[],e.passcode="",e.selectedIndex=-1,e.selectedTpsIndex=-1,e}return Object(o["d"])(e,t),Object.defineProperty(e.prototype,"locations",{get:function(){return this.selectedIndex>=0?this.list[this.selectedIndex].locations:[]},enumerable:!0,configurable:!0}),e.prototype.created=function(){var t=this;"function"!=typeof window["WebSocket"]&&alert("Perangkat anda tidak mendukung"),this.$api.listQuickcount().then((function(e){return t.list=e}))},e.prototype.pilihQuickcount=function(t,e){this.selectedIndex=t,this.dialogTps=!0},e.prototype.pilihTps=function(t,e){this.selectedTpsIndex=t,this.passcode=localStorage["voter_"+this.selectedIndex+"_"+this.selectedTpsIndex]||"",this.dialog=!0},e.prototype.submit=function(){var t=this;this.$api.voterCheck(this.selectedIndex,this.selectedTpsIndex,this.passcode).then((function(e){e.valid?(localStorage["voter_"+t.selectedIndex+"_"+t.selectedTpsIndex]=t.passcode,t.$router.replace("/voter/dash/"+t.selectedIndex+"/"+t.selectedTpsIndex)):alert("Invalid passcode")})).catch((function(t){return alert(t.message)}))},e=Object(o["c"])([Object(s["a"])({name:"VoterLogin",components:{Navbar:r["a"]}})],e),e}(s["c"]),l=c,u=l,d=n("a6c2"),f=n("411c"),p=n.n(f),h=n("9c46"),m=n("d58c"),v=n("e47e"),g=n("f56c"),b=n("d0fe"),y=n("c56b"),w=n("04f4"),T=n("47cea"),_=n("6a74"),k=n("add5"),x=n("d751"),I=n("27a3"),C=n("583a"),S=n("1ae9"),$=n("79b8"),O=Object(d["a"])(u,a,i,!1,null,null,null);e["default"]=O.exports;p()(O,{VBtn:h["a"],VCard:m["a"],VCardText:v["b"],VCardTitle:v["c"],VContainer:g["a"],VContent:b["a"],VDialog:y["a"],VFlex:w["a"],VForm:T["a"],VLayout:_["a"],VList:k["a"],VListItem:x["a"],VListItemContent:I["b"],VListItemTitle:I["d"],VTextField:C["a"],VToolbar:S["a"],VToolbarTitle:$["b"]})},"85e5":function(t,e,n){(function(t,e){(function(t,n){"use strict";if(!t.setImmediate){var a,i=1,o={},s=!1,r=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?p():h()?m():t.MessageChannel?v():r&&"onreadystatechange"in r.createElement("script")?g():b(),c.setImmediate=l,c.clearImmediate=u}function l(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return o[i]=s,a(i),i++}function u(t){delete o[t]}function d(t){var e=t.callback,a=t.args;switch(a.length){case 0:e();break;case 1:e(a[0]);break;case 2:e(a[0],a[1]);break;case 3:e(a[0],a[1],a[2]);break;default:e.apply(n,a);break}}function f(t){if(s)setTimeout(f,0,t);else{var e=o[t];if(e){s=!0;try{d(e)}finally{u(t),s=!1}}}}function p(){a=function(t){e.nextTick((function(){f(t)}))}}function h(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}function m(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"===typeof n.data&&0===n.data.indexOf(e)&&f(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),a=function(n){t.postMessage(e+n,"*")}}function v(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;f(e)},a=function(e){t.port2.postMessage(e)}}function g(){var t=r.documentElement;a=function(e){var n=r.createElement("script");n.onreadystatechange=function(){f(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}function b(){a=function(t){setTimeout(f,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,n("a42b"),n("e48b"))},a0f5:function(t,e,n){(function(t){var a="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,a,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,a,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(a,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n("85e5"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n("a42b"))},ab28:function(t,e){t.exports=function(t,e){var n="function"===typeof t.exports?t.exports.extendOptions:t.options;for(var a in"function"===typeof t.exports&&(n.directives=t.exports.options.directives),n.directives=n.directives||{},e)n.directives[a]=n.directives[a]||e[a]}},e48b:function(t,e){var n,a,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function r(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}function c(t){if(a===clearTimeout)return clearTimeout(t);if((a===s||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(t);try{return a(t)}catch(e){try{return a.call(null,t)}catch(e){return a.call(this,t)}}}(function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(t){n=o}try{a="function"===typeof clearTimeout?clearTimeout:s}catch(t){a=s}})();var l,u=[],d=!1,f=-1;function p(){d&&l&&(d=!1,l.length?u=l.concat(u):f=-1,u.length&&h())}function h(){if(!d){var t=r(p);d=!0;var e=u.length;while(e){l=u,u=[];while(++f<e)l&&l[f].run();f=-1,e=u.length}l=null,d=!1,c(t)}}function m(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new m(t,e)),1!==u.length||d||r(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}}]);